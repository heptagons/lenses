\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{lenses}
 [2023/12/28 v0.01]
 
\RequirePackage{tikz}
\RequirePackage{ifthen}

\newcommand{\letterId}[3]{
 \path(#1,#2) node{$\textbf{\em #3}$}; % letter
}

\newcommand{\rhombus}[4] { % color,side,angle
 \definecolor{main}{HTML}{#1}

 \pgfmathsetmacro\cx{(#2-cos(180-#3))/2}
 \pgfmathsetmacro\cy{sin(180-#3)/2}
 \letterId{\cx}{\cy}{#4}

 \begin{scope} \draw[main] (0,0) -- (#2,0); %1
  \begin{scope}[shift={(#2,0)},rotate=#3] \draw[main] (0,0) -- (#2,0); %2
   \begin{scope}[shift={(#2,0)},rotate=180-#3] \draw[main] (0,0) -- (#2,0); %3
    \begin{scope}[shift={(#2,0)},rotate=#3] \draw[main] (0,0) -- (#2,0); %4
    \end{scope}
   \end{scope}
  \end{scope}
 \end{scope}
}

\newcommand{\lense}[5] { % color,side,angle1,angle2,angle3
 \definecolor{main}{HTML}{#1}
 \begin{scope} \draw[main] (0,0) -- (#2,0); %1
  \begin{scope}[shift={(#2,0)},rotate=180-#3] \draw[main] (0,0) -- (#2,0); %2
   \begin{scope}[shift={(#2,0)},rotate=180-#4] \draw[main] (0,0) -- (#2,0); %3
    \begin{scope}[shift={(#2,0)},rotate=180-#5] \draw[main] (0,0) -- (#2,0); %4
     \begin{scope}[shift={(#2,0)},rotate=180-#3] \draw[main] (0,0) -- (#2,0); %4
      \begin{scope}[shift={(#2,0)},rotate=180-#4] \draw[main] (0,0) -- (#2,0); %4
       \begin{scope}[shift={(#2,0)},rotate=180-#5] \draw[main] (0,0) -- (#2,0); %4
       \end{scope}
      \end{scope}
     \end{scope}
    \end{scope}
   \end{scope}
  \end{scope}
 \end{scope}
}

% 5

\newcommand{\pentaconcave}[2]{
 \definecolor{main}{HTML}{#1}
 \pgfmathsetmacro\ca{(#2*cos(36)}
 \pgfmathsetmacro\sa{(#2*sin(36)}
 \pgfmathsetmacro\cb{(#2*cos(72)}
 \pgfmathsetmacro\sb{(#2*sin(72)}
 \fill[main] (0,0)
  -- (#2,0)
  -- ++(+\cb,+\sb)
  -- ++(-\ca,-\sa)
  -- ++(-\ca,+\sa) -- cycle;
 \draw (0,0)
  -- (#2,0)
  -- ++(+\cb,+\sb)
  -- ++(-\ca,-\sa)
  -- ++(-\ca,+\sa) -- cycle;
}

\newcommand{\pentagon}[3]{ % side,letter,colorconcave
 \pentaconcave{#3}{#1}
 \begin{scope}[rotate=108,shift={(#1,0)}]
  \begin{scope}[rotate=-108]
    \ifthenelse{#2=0}{ }{
     \pgfmathsetmacro\cx{(#1*cos(36)}
     \letterId{\cx}{0}{c}
    }
  \end{scope}
  \begin{scope}[rotate=-72] \draw (0,0) -- (#1,0);
   \begin{scope}[shift={(#1,0)},rotate=-72] \draw (0,0) -- (#1,0);
   \end{scope}
  \end{scope}
 \end{scope}
}

\newcommand{\pentagram}[3]{
 \pentaconcave{#3}{#1}
 \begin{scope}[rotate=-36, shift={(#1,0)}, rotate=-144-36]
  \pentaconcave{#3}{#1}
 \end{scope}
 \begin{scope}[shift={(#1,0)},rotate=-36] \draw (0,0) -- (#1,0);
  \begin{scope}[shift={(#1,0)},rotate=-144-18]
   \ifthenelse{#2=0}{ }{
    \pgfmathsetmacro\cx{#1*cos(18)}
    \letterId{\cx}{0}{b}
   }
  \end{scope}
  \begin{scope}[shift={(#1,0)},rotate=-144] \draw (0,0) -- (#1,0);
  \end{scope}
 \end{scope}
}

\newcommand{\pentagonDoubleSide}[2]{
 \draw(0,0) -- (2*#1,0);
 \begin{scope}[rotate=-54]
  \ifthenelse{#2=0}{ }{
   \pgfmathsetmacro\cx{#1*sin(36)}
   \letterId{\cx}{0}{c}
  }
 \end{scope}
}

\newcommand{\pentagonDouble}[2]{
 \begin{scope}[rotate=108,shift={(#1,0)},rotate=-72,shift={(#1,0)}]
  \begin{scope}[rotate=-72] \pentagonDoubleSide{#1}{#2}
   \begin{scope}[shift={(2*#1,0)},rotate=-72] \pentagonDoubleSide{#1}{#2}
    \begin{scope}[shift={(2*#1,0)},rotate=-72] \pentagonDoubleSide{#1}{#2}
     \begin{scope}[shift={(2*#1,0)},rotate=-72] \pentagonDoubleSide{#1}{#2}
      \begin{scope}[shift={(2*#1,0)},rotate=-72] \pentagonDoubleSide{#1}{#2}
      \end{scope}
     \end{scope}
    \end{scope}
   \end{scope}
  \end{scope}
 \end{scope}
}


\newcommand{\rhombusB}[3] { % color,side
 \ifthenelse{#3=0}{
  \rhombus{#1}{#2}{36}{}
 }{
  \rhombus{#1}{#2}{36}{b}
 }
}

\newcommand{\rhombusC}[3] { % color,side
 \ifthenelse{#3=0}{
  \rhombus{#1}{#2}{72}{}
 }{
  \rhombus{#1}{#2}{72}{c}
 }
}


\newcommand{\hexagonB}[1]{
 \begin{scope}[] \rhombusB{0044FF}{#1}{0} \end{scope};
 \begin{scope}[shift={(#1,0)},rotate=-36] \rhombusC{880088}{#1}{0} \end{scope};
 \begin{scope}[rotate=-36] \rhombusB{0044FF}{#1}{0} \end{scope};
 \draw(0,0) ++(180:0.3) node{$B_1$};
 \draw(#1,0) ++(0:0.45) node{$O$};
 \begin{scope}[rotate=36] \draw(#1,0) ++(108:0.3) node{$B_2$};
  \begin{scope}[shift={(#1,0)},rotate=-36] \draw(#1,0) ++(36:0.3) node{$B_3$};
   \begin{scope}[shift={(#1,0)},rotate=-36] \draw(#1,0) ++(18:0.3) node{$B_4$};
    \begin{scope}[shift={(#1,0)},rotate=-108] \draw(#1,0) ++(108:0.3) node{$B_5$};
     \begin{scope}[shift={(#1,0)},rotate=-36] \draw(#1,0) ++(36:0.3) node{$B_6$};
     \end{scope}
    \end{scope}
   \end{scope}
  \end{scope}
 \end{scope}
}

\newcommand{\hexagonC}[1]{
 \begin{scope}[] \rhombusC{880088}{#1}{0} \end{scope};
 \begin{scope}[rotate=-72] \rhombusC{880088}{#1}{0} \end{scope};
 \begin{scope}[rotate=-72,shift={(#1,0)}, rotate=144] \rhombusB{0044FF}{#1}{0} \end{scope};
 \draw(0,0) ++(180:0.3) node{$O$};
 \draw(0.5,0) ++(180:0.15) node{$C_1$};
 \begin{scope}[rotate=72] \draw(#1,0) ++(72:0.3) node{$C_2$};
  \begin{scope}[shift={(#1,0)},rotate=-72] \draw(#1,0) ++(18:0.3) node{$C_3$};
   \begin{scope}[shift={(#1,0)},rotate=-108] \draw(#1,0) ++(108:0.3) node{$C_4$};
    \begin{scope}[shift={(#1,0)},rotate=36] \draw(#1,0) ++(72:0.3) node{$C_5$};
     \begin{scope}[shift={(#1,0)},rotate=-108] \draw(#1,0) ++(0:0.3) node{$C_6$};
     \end{scope}
    \end{scope}
   \end{scope}
  \end{scope}
 \end{scope}
}   



\newcommand{\lenseB}[3] { % color,side
 \lense{#1}{#2}{144}{144}{72}
 \begin{scope}[rotate=36]
  \ifthenelse{#3=0}{ }{
   \pgfmathsetmacro\cx{#2*cos(36) + #2/2}
   \letterId{\cx}{0}{B}
  }
 \end{scope}
}

\newcommand{\lenseC}[3] { % color,side
 \lense{#1}{#2}{72}{216}{72}
 \begin{scope}[shift={(#2/2,0)},rotate=90]
  \ifthenelse{#3=0}{ }{
   \letterId{1}{0}{C}
  }
 \end{scope}
}


% 7
\newcommand{\heptaconcave}[2]{
 \definecolor{main}{HTML}{#1}
 \pgfmathsetmacro\angle{180/7}
 \pgfmathsetmacro\ca{(#2*cos(\angle)}
 \pgfmathsetmacro\sa{(#2*sin(\angle)}
 \pgfmathsetmacro\cb{(#2*cos(2*\angle)}
 \pgfmathsetmacro\sb{(#2*sin(2*\angle)}
 \pgfmathsetmacro\cc{(#2*cos(3*\angle)}
 \pgfmathsetmacro\sc{(#2*sin(3*\angle)}
 \fill[main] (0,0) -- (#2,0)
  -- ++(+\cb,+\sb)
  -- ++(-\ca,-\sa)
  -- ++(-\cc,+\sc) 
  -- ++(-\cc,-\sc)
  -- ++(-\ca,+\sa) 
  -- cycle;
 \draw[black] (0,0) -- (#2,0)
  -- ++(+\cb,+\sb)
  -- ++(-\ca,-\sa)
  -- ++(-\cc,+\sc) 
  -- ++(-\cc,-\sc)
  -- ++(-\ca,+\sa) 
  -- cycle;
}

\newcommand{\heptagon}[3]{ % side,letter,colorconcave
 \heptaconcave{#3}{#1}
 \pgfmathsetmacro\a{180/7}
 \begin{scope}[rotate=5*\a,shift={(#1,0)},rotate=-2*\a,shift={(#1,0)}]
  %\draw(0,0) node{$1$};
  \begin{scope}[rotate=7*\a] \rhombusF{000000}{#1}{1} \end{scope}
  \begin{scope}[rotate=-4*\a] \rhombusE{000000}{#1}{1} \end{scope}
  \begin{scope}[rotate=-4*\a,shift={(#1,0)},rotate=2*\a,shift={(#1,0)}]
   %\draw(0,0) node{$2$};
   \begin{scope}[rotate=-7*\a] \rhombusF{000000}{#1}{1} \end{scope}
  \end{scope}
 \end{scope}
}

\newcommand{\heptagramThree}[3]{ % side,letter,colorconcave
 \pgfmathsetmacro\a{180/7}
 \heptaconcave{#3}{#1}
 \begin{scope}[rotate=-\a]
  \rhombusD{000000}{#1}{1}
  \begin{scope}[shift={(#1,0)}]
   \begin{scope}[rotate=7*\a] \heptaconcave{#3}{#1} \end{scope}
  \end{scope}
 \end{scope}
}

\newcommand{\heptagramTwo}[3]{ % side,letter,colorconcave
 \heptagramThree{#1}{#2}{#3}
 \begin{scope}[rotate=5*\a]
  \rhombusF{000000}{#1}{1}
 \end{scope}
 \begin{scope}[rotate=5*\a,shift={(#1,0)},rotate=8*\a,shift={(#1,0)}]
  \begin{scope}[rotate=4*\a] \rhombusF{000000}{#1}{1} \end{scope} %\draw(0,0) node{$1$};
  \begin{scope}[rotate=4*\a,shift={(#1,0)},rotate=8*\a,shift={(#1,0)}]
   \begin{scope}[rotate=4*\a] \rhombusF{000000}{#1}{1} \end{scope} %\draw(0,0) node{$2$};
   \begin{scope}[rotate=4*\a,shift={(#1,0)},rotate=8*\a,shift={(#1,0)}]
    \begin{scope}[rotate=4*\a] \rhombusF{000000}{#1}{1} \end{scope} %\draw(0,0) node{$3$};
    \begin{scope}[rotate=4*\a,shift={(#1,0)},rotate=8*\a,shift={(#1,0)}]
     \begin{scope}[rotate=4*\a] \rhombusF{000000}{#1}{1} \end{scope} %\draw(0,0) node{$4$};
     \begin{scope}[rotate=4*\a,shift={(#1,0)},rotate=8*\a,shift={(#1,0)}]
      \begin{scope}[rotate=4*\a] \rhombusF{000000}{#1}{1} \end{scope} %\draw(0,0) node{$5$};
      \begin{scope}[rotate=4*\a,shift={(#1,0)},rotate=8*\a,shift={(#1,0)}]
       \begin{scope}[rotate=4*\a] \rhombusF{000000}{#1}{1} \end{scope} %\draw(0,0) node{$6$};
      \end{scope}
     \end{scope}
    \end{scope}
   \end{scope}
  \end{scope}
 \end{scope}
}

\newcommand{\heptagonDouble}[3]{
 \heptagramTwo{#1}{#2}{#3}
 \begin{scope}[rotate=5*\a,shift={(#1,0)},rotate=3*\a,shift={(#1,0)}]
  \begin{scope}[rotate=2*\a] \rhombusE{000000}{#1}{1} \end{scope} %\draw(0,0) node{$0$};
  \begin{scope}[rotate=7*\a,shift={(#1,0)},rotate=2*\a,shift={(#1,0)}]
   \begin{scope}[rotate=5*\a] \rhombusE{000000}{#1}{1} \end{scope} %\draw(0,0) node{$1$};
   \begin{scope}[rotate=-4*\a,shift={(#1,0)},rotate=2*\a,shift={(#1,0)}]
    \begin{scope}[rotate=5*\a] \rhombusE{000000}{#1}{1} \end{scope} %\draw(0,0) node{$2$};
    \begin{scope}[rotate=-4*\a,shift={(#1,0)},rotate=2*\a,shift={(#1,0)}]
     \begin{scope}[rotate=5*\a] \rhombusE{000000}{#1}{1} \end{scope} %\draw(0,0) node{$3$};
     \begin{scope}[rotate=-4*\a,shift={(#1,0)},rotate=2*\a,shift={(#1,0)}]
      \begin{scope}[rotate=5*\a] \rhombusE{000000}{#1}{1} \end{scope} %\draw(0,0) node{$4$};
      \begin{scope}[rotate=-4*\a,shift={(#1,0)},rotate=2*\a,shift={(#1,0)}]
       \begin{scope}[rotate=5*\a] \rhombusE{000000}{#1}{1} \end{scope} %\draw(0,0) node{$5$};
       \begin{scope}[rotate=-4*\a,shift={(#1,0)},rotate=2*\a,shift={(#1,0)}]
        \begin{scope}[rotate=5*\a] \rhombusE{000000}{#1}{1} \end{scope} %\draw(0,0) node{$$6};
       \end{scope}
      \end{scope}
     \end{scope}
    \end{scope}
   \end{scope}
  \end{scope}
 \end{scope}

}

\newcommand{\rhombusD}[3] { % color,side
 \ifthenelse{#3=0}{
  \rhombus{#1}{#2}{180/7}{}
 }{
  \rhombus{#1}{#2}{180/7}{d}
 }
}

\newcommand{\rhombusE}[3] { % color,side
 \ifthenelse{#3=0}{
  \rhombus{#1}{#2}{360/7}{}
 }{
  \rhombus{#1}{#2}{360/7}{e}
 }
}

\newcommand{\rhombusF}[3] { % color,side
 \ifthenelse{#3=0}{
  \rhombus{#1}{#2}{540/7}{}
 }{
  \rhombus{#1}{#2}{540/7}{f}
 }
}



